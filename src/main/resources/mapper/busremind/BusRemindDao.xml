<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wonders.health.tumor.busremind.dao.BusRemindDao">
	<!--
	a crc_person_info
	b crc_fobt
	c crc_fobt_remind
	d crc_regcase
	e crc_diag_check_remind
	f lic_regcase
	g lic_diag_check_remind
	h sc_regcase
	-->

	<!--查询项目：一览-->
	<sql id="CancerPersonInfoColumns">
		a.id AS "cancerPersonInfo.id",
		a.personcard AS "cancerPersonInfo.personcard",
		a.name AS "cancerPersonInfo.name",
		a.gender AS "cancerPersonInfo.gender",
		a.telephone AS "cancerPersonInfo.telephone",
		a.mobile AS "cancerPersonInfo.mobile",
		a.address_detail AS "cancerPersonInfo.addressDetail"
	</sql>

	<!--查询项目：大肠癌便隐血提醒-->
	<sql id="CrcFobtColumns">
		b.crc_check_id AS "crcFobt.crcCheckId",
		b.first_fobt_result AS "crcFobt.firstFobtResult",
		b.second_fobt_result AS "crcFobt.secondFobtResult"
	</sql>
	<sql id="CrcFobtRemindColumns">
		c.id AS "fobtR.id",
		c.first_fobt_remind_date AS "fobtR.firstFobtRemindDate",c.first_fobt_remind_type AS "fobtR.firstFobtRemindType",
		c.second_fobt_remind_date AS "fobtR.secondFobtRemindDate",c.second_fobt_remind_type AS "fobtR.secondFobtRemindType",
		c.per_fobt_remind_date AS "fobtR.perFobtRemindDate",
		c.fobt_remind_status AS "fobtR.fobtRemindStatus"
	</sql>

	<!--查询项目：大肠癌诊断提醒-->
	<sql id="CrcRegcaseColumns">
		d.id AS "crcRegcase.id",
		d.regdate as "crcRegcase.regdate",
  		d.check_result as "crcRegcase.checkResult",
  		d.id_number AS "crcRegcase.idNumber"
	</sql>
	<sql id="CrcDiagCheckRemindColumns">
  		e.id AS "crcDiag.id",e.crc_check_id AS "crcDiag.crcCheckId",
  		e.first_remind_date AS "crcDiag.firstRemindDate",e.first_remind_type AS "crcDiag.firstRemindType",
  		e.second_remind_date AS "crcDiag.secondRemindDate",e.second_remind_type AS "crcDiag.secondRemindType",
  		e.third_remind_date AS "crcDiag.thirdRemindDate",e.third_remind_type AS "crcDiag.thirdRemindType",
  		e.per_remind_date AS "crcDiag.perRemindDate",
  		e.remind_status AS "crcDiag.remindStatus"
	</sql>

	<!--查询项目：肝癌诊断提醒-->
	<sql id="LicRegcaseColumns">
		f.check_result AS "licRegcase.checkResult",
		f.id AS "licRegcase.id"
	</sql>
	<sql id="LicDiagCheckRemindColumns">
		g.id AS "licDiag.id",g.lic_check_id AS "licDiag.licCheckId",
		g.check_year AS "licDiag.checkYear",
		g.per_remind_date AS "licDiag.perRemindDate",
		g.remind_status AS "licDiag.remindStatus",
		g.first_remind_date AS "licDiag.firstRemindDate",g.first_remind_type AS "licDiag.firstRemindType",
		g.second_remind_date AS "licDiag.secondRemindDate",g.second_remind_type AS "licDiag.secondRemindType",
		g.third_remind_date AS "licDiag.thirdRemindDate",g.third_remind_type AS "licDiag.thirdRemindType"
	</sql>

	<!--查询项目：胃癌诊断提醒-->
	<sql id="ScRegcaseColumns">
		h.check_result as "scRegcase.checkResult",
		h.id AS "scRegcase.id"
	</sql>
	<sql id="ScDiagCheckRemindColumns">
		i.id AS "scDiag.id",i.sc_check_id AS "scDiag.scCheckId",
		i.first_remind_date AS "scDiag.firstRemindDate",i.first_remind_type AS "scDiag.firstRemindType",
		i.second_remind_date AS "scDiag.secondRemindDate",i.second_remind_type AS "scDiag.secondRemindType",
		i.third_remind_date AS "scDiag.thirdRemindDate",i.third_remind_type AS "scDiag.thirdRemindType",
		i.per_remind_date AS "scDiag.perRemindDate",
		i.remind_status AS "scDiag.remindStatus"
	</sql>

	<!--查询项目：肺癌诊断提醒-->
	<sql id="LucRegcaseColumns">
		j.check_result as "lucRegcase.checkResult",
		j.id AS "lucRegcase.id"
	</sql>
	<sql id="LucDiagCheckRemindColumns">
		k.id AS "lucDiag.id",k.luc_check_id AS "lucDiag.lucCheckId",
		k.first_remind_date AS "lucDiag.firstRemindDate",k.first_remind_type AS "lucDiag.firstRemindType",
		k.second_remind_date AS "lucDiag.secondRemindDate",k.second_remind_type AS "lucDiag.secondRemindType",
		k.third_remind_date AS "lucDiag.thirdRemindDate",k.third_remind_type AS "lucDiag.thirdRemindType",
		k.per_remind_date AS "lucDiag.perRemindDate",k.remind_status AS "lucDiag.remindStatus"
	</sql>


	<!-- from模块 -->
	<sql id="pageFromBase">
      FROM cancer_person_info a
    </sql>

	<sql id="pageFromCrcfobt">
	  LEFT JOIN crc_regcase d on a.id=d.manageid AND d .del_flag = '0'
	  LEFT JOIN crc_fobt_remind c on d.id=c.crc_check_id AND c.del_flag = '0'
	  LEFT JOIN crc_fobt b on d.id=b.crc_check_id AND b.del_flag = '0'
	  LEFT JOIN crc_diag_check_remind e on d.id=e.crc_check_id AND e.del_flag = '0'
	</sql>

	<sql id="pageFromOther">
		<if test="crcFlag!='' and crcFlag!=null">
			LEFT JOIN crc_regcase d on a.id=d.manageid AND d .del_flag = '0'
			AND d.check_result='2'
			<if test="orgCode!=null and orgCode!=''">
				AND d.regorg=#{orgCode}
			</if>
			LEFT JOIN crc_diag_check_remind e on d.id=e.crc_check_id  AND e.del_flag = '0'
		</if>

		<if test="licFlag!='' and licFlag!=null">
			LEFT JOIN lic_regcase f on a.id=f.manageid AND f.del_flag='0'
			AND f.check_result='2'
			<if test="orgCode!=null and orgCode!=''">
				AND f.regorg=#{orgCode}
			</if>
			LEFT JOIN lic_diag_check_remind g on f.id=g.lic_check_id AND g.del_flag='0'

		</if>
		<if test="scFlag!='' and scFlag!=null">
			LEFT JOIN sc_regcase h on a.id=h.manageid AND h.del_flag='0'
			AND h.check_result='2'

			<if test="orgCode!=null and orgCode!=''">
				AND h.regorg=#{orgCode}
			</if>
			LEFT JOIN sc_diag_check_remind i on h.id=i.sc_check_id AND i.del_flag='0'

		</if>
		<if test="lucFlag!='' and lucFlag!=null">
			LEFT JOIN luc_regcase j on a.id=j.manageid AND j.del_flag='0'
			AND j.check_result='2'

			<if test="orgCode!=null and orgCode!=''">
				AND j.regorg=#{orgCode}
			</if>
			LEFT JOIN luc_diag_check_remind k on j.id=k.luc_check_id AND k.del_flag='0'

		</if>
	</sql>

	<!-- where模块 -->
	<sql id="pageWhereBase">
		a.del_flag='0'
		<if test="keyword!=null and keyword!='' ">
			AND (
				a.name LIKE	CONCAT(CONCAT('%',#{keyword}),'%')
				OR
				a.personcard LIKE CONCAT(CONCAT('%',#{keyword}),'%')
			)
		</if>
	</sql>

	<sql id="pageWhereCrcFobt">
		<if test="crcFlag!='' and crcFlag!=null">
			AND d.del_flag='0'
			AND ((c.fobt_remind_status IS NOT NULL) or (e.remind_status IS NOT NULL))
			<if test="remindType == '01'.toString()">
				<if test="year!=null and year!=''">
					AND c.check_year=#{year}
				</if>
				<if test="status!=null and status!=''">
					AND c.fobt_remind_status=#{status}
				</if>
			</if>
			<if test="remindType == '02'.toString()">
				<if test="year!=null and year!=''">
					AND e.check_year=#{year}
				</if>
				<if test="status!=null and status!=''">
					AND e.remind_status=#{status}
				</if>
			</if>
			<if test="remindType == '' or remindType==null">
				<if test="status!=null and status!=''">
					AND (c.fobt_remind_status=#{status} or e.remind_status=#{status})
				</if>
			</if>
			<if test="startDate!=null and startDate!=''">
				<if test="remindType == '01'.toString()">
					AND (
						c.per_fobt_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND c.fobt_remind_status=#{status}
						</if>
					)
				</if>
				<if test="remindType == '02'.toString()">
					AND (
						e.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND e.remind_status=#{status}
						</if>
					)
				</if>
				<if test="remindType == '' or remindType==null">
					AND (
						(c.per_fobt_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
							<if test="status!=null and status!=''">AND c.fobt_remind_status=#{status}
							</if>
						)
						OR (
							e.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
							<if test="status!=null and status!=''">
								AND e.remind_status=#{status}
							</if>
						)
					)
				</if>
			</if>
			<if test="endDate!=null and endDate!=''">
				<if test="remindType == '01'.toString()">
					AND (
						c.per_fobt_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND c.fobt_remind_status=#{status}
						</if>
					)
				</if>
				<if test="remindType == '02'.toString()">
					AND (
						e.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND e.remind_status=#{status}
						</if>
					)
				</if>
				<if test="remindType == '' or remindType==null">
					AND (
						(
						c.per_fobt_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND c.fobt_remind_status=#{status}
						</if>
						)
					OR (
						e.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
						<if test="status!=null and status!=''">
							AND e.remind_status=#{status}
						</if>
						)
					)
				</if>
			</if>
			<if test="year!=null and year!=''">
				AND d.check_year=#{year}
			</if>
		</if>
	</sql>

	<sql id="pageWhereOther">
		AND(
		<if test="crcFlag!='' and crcFlag!=null">
			E .remind_status IS NOT NULL OR
		</if>
		<if test="licFlag!='' and licFlag!=null">
			G .remind_status IS NOT NULL OR
		</if>
		<if test="scFlag!='' and scFlag!=null">
			I .remind_status IS NOT NULL OR
		</if>
		<if test="lucFlag!='' and lucFlag!=null">
			K .remind_status IS NOT NULL OR
		</if>
		1=2
		)
		<if test="status!=null and status!=''">
			AND(
			1=2 OR
			<if test="crcFlag!='' and crcFlag!=null">
				e.remind_status=#{status} OR
			</if>
			1=2 OR
			<if test="licFlag!='' and licFlag!=null">
				g.remind_status=#{status}  OR
			</if>
			1=2 OR
			<if test="scFlag!='' and scFlag!=null">
				i.remind_status=#{status}  OR
			</if>
			1=2 OR
			<if test="lucFlag!='' and lucFlag!=null">
				k.remind_status=#{status} OR
			</if>
			1=2)
		</if>

		<if test="year!=null and year!=''">
			AND (1=2
			OR(
			1=2 OR
			<if test="crcFlag!='' and crcFlag!=null">
				(d.check_year=#{year} AND E .check_year =#{year} )OR
			</if>
			<if test="licFlag!='' and licFlag!=null">
				(f.check_year=#{year} AND g.check_year=#{year} ) OR
			</if>
			<if test="scFlag!='' and scFlag!=null">
				(h.check_year=#{year} AND i.check_year=#{year} ) OR
			</if>
			<if test="lucFlag!='' and lucFlag!=null">
				(j.check_year=#{year} AND k.check_year=#{year} )OR
			</if>
			1=2
			))
		</if>
		<if test="startDate!=null and startDate!=''">
			AND (1=2
			OR(
			1=2 OR
			<if test="crcFlag!='' and crcFlag!=null">
				(
					e.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND e.remind_status=#{status}
					</if>
				)OR
			</if>
			<if test="licFlag!='' and licFlag!=null">
				(
					g.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND g.remind_status=#{status}
					</if>
				)OR
			</if>
			<if test="scFlag!='' and scFlag!=null">
				(
					i.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND i.remind_status=#{status}
					</if>
				)  OR
			</if>
			<if test="lucFlag!='' and lucFlag!=null">
				(
					k.per_remind_date >= to_date(#{startDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND k.remind_status=#{status}
					</if>
				) OR
			</if>
			1=2
			))

		</if>
		<if test="endDate!=null and endDate!=''">
			AND (1=2
			OR(
			1=2 OR
			<if test="crcFlag!='' and crcFlag!=null">
				(
					e.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND e.remind_status=#{status}
					</if>
				)OR
			</if>
			<if test="licFlag!='' and licFlag!=null">
				(
					g.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND g.remind_status=#{status}
					</if>
				)OR
			</if>
			<if test="scFlag!='' and scFlag!=null">
				(
					i.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND i.remind_status=#{status}
					</if>
				)OR
			</if>
			<if test="lucFlag!='' and lucFlag!=null">
				(
					k.per_remind_date &lt;= to_date(#{endDate},'yyyy-MM-dd HH24:Mi:ss')
					<if test="status!=null and status!=''">
						AND k.remind_status=#{status}
					</if>
				)OR
			</if>
			1=2
			))
		</if>
	</sql>


	<select id="getBasic"  resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo"
            parameterType="com.wonders.health.tumor.common.model.DataGridSearch">
		<choose>
			<when test="startRecord == 0">
		select DISTINCT * from (
			</when>
			<otherwise>
		select  DISTINCT * from ( select row_.*, rownum rownum_ from (
			</otherwise>
		</choose>
		<choose>
			<when test="remindType == null or remindType == ''.toString()">
				SELECT DISTINCT
				<include refid="CancerPersonInfoColumns"/>
				<include refid="pageFromBase"/>
				<include refid="pageFromCrcfobt"/>
				WHERE
				<include refid="pageWhereBase"/>
				<include refid="pageWhereCrcFobt"/>

				UNION ALL

				SELECT
				<include refid="CancerPersonInfoColumns"/>
				<include refid="pageFromBase"/>
				<include refid="pageFromOther"/>
				WHERE
				<include refid="pageWhereBase"/>
				<include refid="pageWhereOther"/>
			</when>
			<otherwise>
				SELECT DISTINCT
				<include refid="CancerPersonInfoColumns"/>
				<include refid="pageFromBase"/>
				<choose>
					<when test="remindType == '01'.toString()">
						<include refid="pageFromCrcfobt"/>
					</when>
					<when test="remindType == '02'.toString()">
						<include refid="pageFromOther"/>
					</when>
				</choose>
				WHERE
				<include refid="pageWhereBase"/>
				<choose>
					<when test="remindType == '01'.toString()">
						<include refid="pageWhereCrcFobt"/>
					</when>
					<when test="remindType == '02'.toString()">
						<include refid="pageWhereOther"/>
					</when>
				</choose>
			</otherwise>

		</choose>

		<choose>
			<when test="sortField != null and sortField != '' and sortOrder != '' and sortOrder != ''">
				ORDER BY ${sortField} ${sortOrder}
			</when>
			<otherwise>
			</otherwise>
		</choose>
		<choose>
			<when test="startRecord == 0">
		) row_ where rownum &lt;= #{pageSize}
			</when>
			<otherwise>
		) row_ where rownum &lt;= #{endRecord}) where rownum_ &gt; #{startRecord}
			</otherwise>
		</choose>
    </select>

	<select id="getCrcFobtRemind" resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo" parameterType="java.lang.String">
		SELECT
		 <include refid="CrcRegcaseColumns"/>,
		 <include refid="CrcFobtColumns"/>,
		 <include refid="CrcFobtRemindColumns"/>
		<include refid="pageFromBase"/>
		<include refid="pageFromCrcfobt"/>
		WHERE
			a.personcard=#{personcard}
		<if test="status!=null and status!=''">
			AND c.fobt_remind_status=#{status}
		</if>
		<if test="year!=null and year!=''">
			AND c.check_year=#{year}
			AND d.check_year=#{year}
		</if>
	</select>

	<select id="getCrcDiag" resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo" parameterType="java.lang.String">
		SELECT
		<include refid="CrcRegcaseColumns"/>,
		<include refid="CrcDiagCheckRemindColumns"/>
		<include refid="pageFromBase"/>
		<include refid="pageFromOther"/>
		WHERE
		a.personcard=#{personcard}
		AND d.check_result='2'
		AND	e.remind_status IS NOT NULL
		<if test="status!=null and status!=''">
			AND	e.remind_status=#{status}
		</if>
		<if test="year!=null and year!=''">
			AND d.check_year=#{year}
			AND e.check_year=#{year}
		</if>
	</select>

	<select id="getLicDiag" resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo" parameterType="java.lang.String">
		SELECT
		<include refid="LicRegcaseColumns"/>,
		<include refid="LicDiagCheckRemindColumns"/>
		<include refid="pageFromBase"/>
		<include refid="pageFromOther"/>
		WHERE
		a.personcard=#{personcard}
		AND f.check_result='2'
		AND	g.remind_status IS NOT NULL
		<if test="status!=null and status!=''">
			AND	g.remind_status=#{status}
		</if>
		<if test="year!=null and year!=''">
			AND f.check_year=#{year}
			AND g.check_year=#{year}
		</if>
	</select>

	<select id="getScDiag" resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo" parameterType="java.lang.String">
		SELECT
		<include refid="ScRegcaseColumns"/>,
		<include refid="ScDiagCheckRemindColumns"/>
		<include refid="pageFromBase"/>
		<include refid="pageFromOther"/>
		WHERE
		a.personcard=#{personcard}
		AND h.check_result='2'
		AND	i.remind_status IS NOT NULL
		<if test="status!=null and status!=''">
			AND	i.remind_status=#{status}
		</if>
		<if test="year!=null and year!=''">
			AND h.check_year=#{year}
			AND i.check_year=#{year}
		</if>
	</select>

	<select id="getLucDiag" resultType="com.wonders.health.tumor.busremind.vo.BusRemindResultVo" parameterType="java.lang.String">
		SELECT
		<include refid="LucRegcaseColumns"/>,
		<include refid="LucDiagCheckRemindColumns"/>
		<include refid="pageFromBase"/>
		<include refid="pageFromOther"/>
		WHERE
		a.personcard=#{personcard}
		AND j.check_result='2'
		AND	k.remind_status IS NOT NULL
		<if test="status!=null and status!=''">
			AND	k.remind_status=#{status}
		</if>
		<if test="year!=null and year!=''">
			AND j.check_year=#{year}
			AND k.check_year=#{year}
		</if>
	</select>


	<!--以下为提醒方式update-->
	<update id="updateCrcFobtRemind">
		UPDATE crc_fobt_remind SET
		<if test="firstFobtRemindDate!=null">
			first_fobt_remind_date =  #{firstFobtRemindDate},
		</if>
		<if test="firstFobtRemindType!=null and firstFobtRemindType !=''">
			first_fobt_remind_type = #{firstFobtRemindType},
		</if>
		<if test="secondFobtRemindDate!=null">
			second_fobt_remind_date =  #{secondFobtRemindDate},
		</if>
		<if test="secondFobtRemindType!=null and secondFobtRemindType !=''">
			second_fobt_remind_type = #{secondFobtRemindType},
		</if>
		<if test="perFobtRemindDate!=null ">
			per_fobt_remind_date = #{perFobtRemindDate},
		</if>
		fobt_remind_status = #{fobtRemindStatus},
		update_by = #{updateBy},update_date = #{updateDate}

		WHERE id = #{id}
	</update>

	<update id="updateCrcDiag">
		UPDATE crc_diag_check_remind SET
			<if test="firstRemindDate!=null">
				first_remind_date = #{firstRemindDate},
			</if>
			<if test="firstRemindType!=null and firstRemindType !=''">
				first_remind_type = #{firstRemindType},
			</if>
			<if test="secondRemindDate!=null">
				second_remind_date = #{secondRemindDate},
			</if>
			<if test="secondRemindType!=null and secondRemindType !=''">
				second_remind_type = #{secondRemindType},
			</if>
			<if test="thirdRemindDate!=null">
				third_remind_date = #{thirdRemindDate},
			</if>

			<if test="thirdRemindType!=null and thirdRemindType !=''">
				third_remind_type = #{thirdRemindType},
			</if>
			<if test="perRemindDate!=null ">
				per_remind_date = #{perRemindDate},
			</if>
			remind_status = #{remindStatus},
			update_by = #{updateBy},update_date = #{updateDate}
		WHERE id = #{id}
	</update>

	<update id="updateLicDiag">
		UPDATE lic_diag_check_remind SET
		<if test="firstRemindDate!=null">
			first_remind_date = #{firstRemindDate},
		</if>
		<if test="firstRemindType!=null and firstRemindType !=''">
			first_remind_type = #{firstRemindType},
		</if>
		<if test="secondRemindDate!=null">
			second_remind_date = #{secondRemindDate},
		</if>
		<if test="secondRemindType!=null and secondRemindType !=''">
			second_remind_type = #{secondRemindType},
		</if>
		<if test="thirdRemindDate!=null">
			third_remind_date = #{thirdRemindDate},
		</if>

		<if test="thirdRemindType!=null and thirdRemindType !=''">
			third_remind_type = #{thirdRemindType},
		</if>
		<if test="perRemindDate!=null ">
			per_remind_date = #{perRemindDate},
		</if>
		remind_status = #{remindStatus},
		update_by = #{updateBy},update_date = #{updateDate}
		WHERE id = #{id}
	</update>

	<update id="updateScDiag">
		UPDATE sc_diag_check_remind SET
		<if test="firstRemindDate!=null">
			first_remind_date = #{firstRemindDate},
		</if>
		<if test="firstRemindType!=null and firstRemindType !=''">
			first_remind_type = #{firstRemindType},
		</if>
		<if test="secondRemindDate!=null">
			second_remind_date = #{secondRemindDate},
		</if>
		<if test="secondRemindType!=null and secondRemindType !=''">
			second_remind_type = #{secondRemindType},
		</if>
		<if test="thirdRemindDate!=null">
			third_remind_date = #{thirdRemindDate},
		</if>
		<if test="thirdRemindType!=null and thirdRemindType !=''">
			third_remind_type = #{thirdRemindType},
		</if>
		<if test="perRemindDate!=null ">
			per_remind_date = #{perRemindDate},
		</if>
		remind_status = #{remindStatus},
		update_by = #{updateBy},update_date = #{updateDate}
		WHERE id = #{id}
	</update>

	<update id="updateLucDiag">
		UPDATE luc_diag_check_remind SET
		<if test="firstRemindDate!=null">
			first_remind_date = #{firstRemindDate},
		</if>
		<if test="firstRemindType!=null and firstRemindType !=''">
			first_remind_type = #{firstRemindType},
		</if>
		<if test="secondRemindDate!=null">
			second_remind_date = #{secondRemindDate},
		</if>
		<if test="secondRemindType!=null and secondRemindType !=''">
			second_remind_type = #{secondRemindType},
		</if>
		<if test="thirdRemindDate!=null">
			third_remind_date = #{thirdRemindDate},
		</if>
		<if test="thirdRemindType!=null and thirdRemindType !=''">
			third_remind_type = #{thirdRemindType},
		</if>
		<if test="perRemindDate!=null ">
			per_remind_date = #{perRemindDate},
		</if>
		remind_status = #{remindStatus},
		update_by = #{updateBy},update_date = #{updateDate}
		WHERE id = #{id}
	</update>







	<update id="delete">
	    UPDATE CRC_FOLLOW SET del_flag = '1'
	    WHERE id = #{id}
	</update>

	<select id="getListByCheckId" resultType="com.wonders.health.tumor.follow.entity.CrcFollow">
		SELECT
		a.*
		FROM CRC_FOLLOW a
		<where>
			a.del_flag = '0'
			AND a.crc_check_id = #{crcCheckId}
		</where>
	</select>
	
</mapper>