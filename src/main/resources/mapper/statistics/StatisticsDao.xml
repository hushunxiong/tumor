<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wonders.health.tumor.statistics.dao.StatisticsDao">
    <!--初筛信息汇总表（阴性）-->
  <select id="getNegative" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.NegativeSummaryVo">
SELECT
	info.name AS xm,
	info.gender AS xb,
	info.birth AS birthday,
	info.address_province as addressProvince,
	info.address_city as addressCity,
	info.address_county as addressCounty,
	info.address_town as addressTown,
	info.address_committee as addressCommittee,
	info.address_detail as addressDetail,
	info.mobile as mobile,
	info.telephone as telephone,
	crc.regorg as regorg,
	crc.regdate as csrq
FROM
	cancer_person_info info left join crc_regcase crc ON info.id = crc.manageid

  </select>





    <!--初筛信息汇总（阳性大肠癌）-->
    <select id="getCrcPositive" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.CrcPositiveSummaryVo">
	SELECT
	info.NAME AS xm,
	info.gender AS xb,
	info.birth AS birthday,
	info.address_province as addressProvince,
	info.address_city as addressCity,
	info.address_county as addressCounty,
	info.address_town as addressTown,
	info.address_committee as addressCommittee,
	info.address_detail as addressDetail,
	crcrisk.ASSESSMENT_RESULT as assessmentResult,
	crcfobt.FOBT_RESULT as fobtResult,
	crcfo.CHANGJING as changjing,
	crcfo.SHIFOUQUEZHEN as sfqz,
	crcfo.SHIFOUZHILIAO as sfzl,
	crcfo.LINCHUANGFENQI as zlqb,
	crcfo.BINGBIANBUW as zlwz,
	info.mobile as mobile,
	info.telephone,
	crc.regorg as regorg,
	crc.regdate as csrq
FROM
	crc_regcase crc
	LEFT JOIN cancer_person_info info ON  crc.manageid =info.id
	left join crc_risk_assessment crcrisk on crc.ID =crcrisk.CRC_CHECK_ID
	left join crc_fobt crcfobt  on crc.ID=crcfobt.CRC_CHECK_ID
	left join crc_follow crcfo on crc.ID=crcfo.CRC_CHECK_ID
WHERE
	crc.check_result =2
		AND info.del_flag =0

		<if test="csrqStart !=null">
			and crc.regdate >=#{csrqStart}
		</if>
		<if test="csrqEnd !=null">
			and crc.regdate &lt;=#{csrqEnd}+1
		</if>
	<if test="regorg != null and regorg !=''">
	and	crc.regorg=#{regorg}
	</if>

    </select>





    <!--初筛信息汇总（阳性肝癌）-->
    <select id="getLicPositive" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.LicPositiveSummaryVo">
SELECT
	info.NAME AS xm,
	info.gender AS xb,
	info.birth AS birthday,
	info.address_province AS addressProvince,
	info.address_city AS addressCity,
	info.address_county AS addressCounty,
	info.address_town AS addressTown,
	info.address_committee AS addressCommittee,
	info.address_detail AS addressDetail,
	info.mobile AS mobile,
	info.telephone,
	lic.REGORG AS REGORG,
	licrisk.assessment_result AS assessmentResult,
	licac.GTP as GPT,
	licac.HBEG as Hbeg,
	licac.AFP AS AFP,
	licac.Bus as Bus,
	licfo.SHIFOUQUEZHEN AS sfqz,
	licfo.SHIFOUZHILIAO AS sfzl,
	licfo.ZHONGLIUWEIZH AS zlwz,
	licfo.linchuangfenqi AS zlqb,
	lic.REGDATE AS csrq
FROM
	lic_regcase lic
	LEFT JOIN cancer_person_info info ON info.id = lic.MANAGEID
	LEFT JOIN lic_risk_assessment licrisk ON lic.id = licrisk.lic_CHECK_ID
	LEFT JOIN lic_FOLLOW licfo ON lic.id = licfo.lic_CHECK_ID
	LEFT JOIN lic_assist_check licac on lic.ID = licac.lic_check_id
WHERE
	lic.check_result = 2
	AND info.del_flag = 0
		<if test="csrqStart !=null">
			and lic.regdate >=#{csrqStart}
		</if>
		<if test="csrqEnd !=null">
			and lic.regdate &lt;=#{csrqEnd}+1
		</if>
		<if test="regorg != null and regorg !=''">
			and	lic.regorg=#{regorg}
		</if>

    </select>





    <!--初筛信息汇总（阳性肺癌）-->
    <select id="getLucPositive" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.LucPositiveSummaryVo">
SELECT
	info.NAME AS xm,
	info.gender AS xb,
	info.birth AS birthday,
	info.address_province AS addressProvince,
	info.address_city AS addressCity,
	info.address_county AS addressCounty,
	info.address_town AS addressTown,
	info.address_committee AS addressCommittee,
	info.address_detail AS addressDetail,
	info.mobile AS mobile,
	info.telephone,
	luc.REGORG AS REGORG,
	lucrisk.assessment_result AS assessmentResult,
	lucfo.shifouLDCT AS shifouLDCT,
	lucfo.LDCT_jieguo AS LDCTJieguo,
	lucfo.SHIFOUQUEZHEN AS sfqz,
	lucfo.SHIFOUZHILIAO AS sfzl,
	lucfo.ZHONGLIUWEIZH AS zlwz,
	lucfo.linchuangfenqi AS zlqb,
	luc.REGDATE AS csrq
FROM
	luc_regcase luc
	LEFT JOIN cancer_person_info info  ON info.id = luc.MANAGEID
	LEFT JOIN luc_risk_assessment lucrisk ON luc.id = lucrisk.LUC_CHECK_ID
	LEFT JOIN LUC_FOLLOW lucfo ON luc.id = lucfo.LUC_CHECK_ID
WHERE
	luc.check_result = 2
	AND info.del_flag = 0
		<if test="csrqStart !=null">
			and luc.regdate >=#{csrqStart}
		</if>
		<if test="csrqEnd !=null">
			and luc.regdate &lt;=#{csrqEnd}+1
		</if>
		<if test="regorg != null and regorg !=''">
			and	luc.regorg=#{regorg}
		</if>
    </select>



    <!--初筛信息汇总（阳性胃癌）-->
    <select id="getScPositive" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.ScPositiveSummaryVo">
SELECT
	info.NAME AS xm,
	info.gender AS xb,
	info.birth AS birthday,
	info.address_province AS addressProvince,
	info.address_city AS addressCity,
	info.address_county AS addressCounty,
	info.address_town AS addressTown,
	info.address_committee AS addressCommittee,
	info.address_detail AS addressDetail,
	info.mobile AS mobile,
	info.telephone,
	sc.REGORG AS REGORG,
	scrisk.assessment_result AS assessmentResult,
	scfo.SHIFOUQUEZHEN AS sfqz,
	scfo.SHIFOUZHILIAO AS sfzl,
	scfo.ZHONGLIUWEIZH AS zlwz,
	scfo.linchuangfenqi AS zlqb,
	sc.REGDATE AS csrq
FROM
	sc_regcase sc
	LEFT JOIN cancer_person_info info  ON info.id = sc.MANAGEID
	LEFT JOIN sc_risk_assessment scrisk ON sc.id = scrisk.sc_CHECK_ID
	LEFT JOIN sc_FOLLOW scfo ON sc.id = scfo.sc_CHECK_ID
WHERE
	sc.check_result = 2
	AND info.del_flag = 0
		<if test="csrqStart !=null">
			and sc.regdate >=#{csrqStart}
		</if>
		<if test="csrqEnd !=null">
			and sc.regdate &lt;=#{csrqEnd}+1
		</if>
		<if test="regorg != null and regorg !=''">
			and	sc.regorg=#{regorg}
		</if>
    </select>
	<!--诊断信息收集表-->
	<select id="getInformation" parameterType="com.wonders.health.tumor.statistics.vo.SummarySearchVo" resultType="com.wonders.health.tumor.statistics.vo.InformationCollectionVo">

	</select>
</mapper>